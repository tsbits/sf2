var Mondrian=function(t,h,i,e,o){this.mapWidth=t||10,this.mapHeight=h||10,this.tileWidth=i||25,this.tileHeight=e||25,this.map=o||[],this.hero={x:10,y:5,speed:.1},this.enemies=[],this.items=[],this.buildMap()};Mondrian.prototype.buildMap=function(t){if(0==this.map.length)for(var h=0;h<this.mapHeight;h++){for(var i=[],e=0;e<this.mapWidth;e++)t?i.push(Math.round(Math.random())):i.push(1);this.map.push(i)}this.makeBorder()},Mondrian.prototype.makeBorder=function(){for(var t=0;t<this.mapHeight;t++)for(var h=0;h<this.mapWidth;h++)0==t||t==this.map.length-1?this.map[t][h]=0:0!=h&&h!=this.map[t].length-1||(this.map[t][h]=0)},Mondrian.prototype.makeWall=function(t,h,i,e){if(e)for(var o=0;i>o;o++)this.map[h+o][t]=0;else for(var o=0;i>o;o++)this.map[h][t+o]=0},Mondrian.prototype.moveHero=function(t,h){0>t&&0!=this.map[Math.round(this.hero.y)][Math.ceil(this.hero.x)-1]&&(this.hero.x+=t*this.hero.speed),t>0&&0!=this.map[Math.round(this.hero.y)][Math.floor(this.hero.x)+1]&&(this.hero.x+=t*this.hero.speed),0>h&&0!=this.map[Math.ceil(this.hero.y)-1][Math.round(this.hero.x)]&&(this.hero.y+=h*this.hero.speed),h>0&&0!=this.map[Math.floor(this.hero.y)+1][Math.round(this.hero.x)]&&(this.hero.y+=h*this.hero.speed)},Mondrian.prototype.moveEnemies=function(){for(var t=0;t<this.enemies.length;t++){var h=this.enemies[t];if(0==h.dir&&0!=this.map[Math.round(h.y)][Math.ceil(h.x)-1])h.x-=h.speed;else if(2==h.dir&&0!=this.map[Math.round(h.y)][Math.floor(h.x)+1])h.x+=h.speed;else if(1==h.dir&&0!=this.map[Math.ceil(h.y)-1][Math.round(h.x)])h.y-=h.speed;else{if(3!=h.dir||0==this.map[Math.floor(h.y)+1][Math.round(h.x)])return void(h.dir=Math.round(3*Math.random()));h.y+=h.speed}Math.random()>.99&&(h.dir=Math.round(3*Math.random()))}},Mondrian.prototype.setHeroStart=function(t,h){this.hero.x=t,this.hero.y=h},Mondrian.prototype.setHeroSize=function(t,h){this.hero.width=t,this.hero.height=h},Mondrian.prototype.addEnemy=function(t,h,i){this.enemies.push({x:t,y:h,speed:i,dir:Math.round(3*Math.random())})},Mondrian.prototype.addItem=function(t,h,i){this.items.push({x:t,y:h,name:i})},Mondrian.prototype.isTileWalkable=function(t,h){var i=!1;return 0!=this.map[h][t]&&(i=!0),i};